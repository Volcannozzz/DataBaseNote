## 并发编程

现代操作系统提供了三种基本的构造并发程序的方法：

1. 进程；
2. I/O多路复用；
3. 线程；

### 1. 基于进程的并发编程

即一个任务对应一个进程；

劣势：进程之间，地址空间独立，因而必须使用IPC。父子进程之间共享状态信息，进程有一个非常清晰的模型：共享文件表，但是不共享地址空间。基于进程的设计，往往比价慢，**因为，进程控制和IPC的开销较高。**

### 2. 基于I/O多路复用的并发编程

这在网络服务中比较明显。因为I/O耗时总是比较长的，可以在I/O完成之后通知线程处理I/O数据。这样，当有多个I/O连接时（例如，对应多个用户），可以用一个线程对多个用户进行服务，即基于I/O多路复用的并发编程。

### 3. 基于线程的并发

线程是CPU调度的基本单位；

#### ① 线程执行模型

一个进程开始其生命周期时都是单一线程的，这个线程称为主线程。在某一时刻该线程可以创建一个**对等线程**，从这个时间点开始，两个线程就开始并发的运行。对等线程概念的主要影响是，一个线程可以杀死他的任何对等线程。

线程上下文的切换比进程上下文的切换要快得多。和一个进程相关的线程组成一个对等线程池。

#### ②Posix线程

Posix线程是C程序中的处理线程的一个标准接口。

#### ③线程存储器模型

如果某个线程以某个方式得到一个指向其他线程栈的指针，那么该线程可以通过这个指针间接使用其他线程栈的内容。

#### ④变量映射到存储器

- 全局变量：定义在函数之外，所有线程共享。
- 本地自动变量：函数内部定义，无static修饰，线程独享。
- 本地静态变量：函数内部定义，有static修饰，每个对等线程都可以读和写这个实例。

#### ⑤可重入性

可重入性函数的特点在于，其内部没有引用任何共享数据；这类函数是一类重要的**线程安全**的函数。